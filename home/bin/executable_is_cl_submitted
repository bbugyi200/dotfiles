#!/bin/bash

if [[ -z "$1" ]]; then
  echo "Usage: $0 <cl_number>"
  exit 1
fi

cl_number="$1"

# Fetch the status of the CL.
# The -F'%status%' flag formats the output to only show the status field.
status=$(p4 -F'%status%' change -o "${cl_number}" 2>/dev/null)

if [[ "$status" == "submitted" ]]; then
  echo "CL ${cl_number} is submitted."
  exit 0
else
  echo "CL ${cl_number} is NOT submitted (or does not exist)."
  exit 1
fi
