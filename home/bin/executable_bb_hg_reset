#!/bin/bash

# Reset the current Mercurial repository to a specific commit hash.
function run() {
  if [[ $# -ne 1 ]]; then
    echo "Usage: $0 <commit-hash>"
    exit 1
  fi

  commit_hash="$1"
  shift

  bb_hg_clean
  hg revert --hidden -r "$commit_hash" $(branch_changes)
  bb_hg_amend "@rev Reset to old commit: $commit_hash"
}

run "$@"
