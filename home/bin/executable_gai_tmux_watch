#!/bin/bash

# main entry point for this script
function run() {
  # Create new pane for tree output
  tm_split_window
  tmux send-keys "watch -c -n 5 tree \$(last_gai_dir)" Enter

  # Create new pane for test process monitoring
  tm_split_window
  local test_cmd="$(last_test_cmd)"
  tmux send-keys "watch -c -n 5 procs '${test_cmd}' | grep -v bash | grep -v watch" Enter
  watch -c -n 5 hg diff --color=always
}
run "$@"
