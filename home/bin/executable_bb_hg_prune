#!/bin/bash

cl_name="$1"
shift

diff_file="$HOME/tmp/bb_hg_prune/${cl_name}-$(date +%y%m%d_%H%M%S).diff"
echo "Stashing CL to $diff_file..."
mkdir -p "$(dirname "$diff_file")"
hg diff -c "$cl_name" >"$diff_file"

echo "Pruning CL..."
hg cls-drop -c "$cl_name" --prune --skip-confirmation
clear_branch_name
