name: file
input:
  - name: name
    type: word

steps:
  - name: inject
    prompt_part: |
      ---
      FILE OUTPUT REQUIREMENTS:

      You MUST write your complete response (summary, research, plan, etc.) to the
      following file:

        bb/gai/file/{{ name }}.md

      Create the directory `bb/gai/file/` if it does not already exist.

      IMPORTANT:
      - The file MUST contain your full response as markdown
      - Do NOT skip writing to the file â€” this is a required step

  - name: verify_file
    hidden: true
    bash: |
      file_path="bb/gai/file/{{ name }}.md"
      if [ ! -f "$file_path" ]; then
        echo "ERROR: Expected file '$file_path' was not created by the agent" >&2
        exit 1
      fi
      if [ ! -s "$file_path" ]; then
        echo "ERROR: File '$file_path' exists but is empty" >&2
        exit 1
      fi
      echo "file_path=$file_path"
    output: { file_path: path }
