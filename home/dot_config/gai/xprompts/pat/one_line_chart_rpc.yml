name: pat/one_line_chart_rpc

xprompts:
  _research: |
    I need to add a new line chart to the PA troubleshooting page on (for Google Ad Manager's FE). We need to make
    sure we only make one RPC to populate the data for the line chart and we have decided to use the OnePlatform
    Reporting API to accomplish this.

steps:
  # Step 1: Run 3 research agents in parallel
  - name: research
    parallel:
      - name: api_research
        prompt: |
          #_research Can you help me do some research on how the OnePlatform Reporting API works?

          #file(name=api_research)

      - name: prior_art
        prompt: |
          #_research Can you help me do some research on prior art in the form of other Dart clients that are
          currently using the OnePlatform Reporting API? Bonus points if you can find any that are using the dimensions
          we need!

          #file(name=prior_art)

      - name: dimensions_metrics
        prompt: |
          #_research Can you help me do some research on what specific dimensions and metrics we need to query
          from the OnePlatform Reporting API?

          #file(name=dimensions_metrics)

  # Step 2: Implementation agent executes the plan
  - name: implementation
    prompt: |
      Can you help me improve the PA troubleshooting page by adding a line chart view in addition to the existing pie
      chart view?

      - We shouldn't show the pie chart and the line chart at the same time ever. So make sure the user has a way to
        toggle between the two.
      - This code lives somewhere in the
        contentads/drx/fe/client/trafficking/private_marketplace/components/deal_check_ui/ directory.
      - This functionality should all be gated behind the ENABLE_PA_TROUBLESHOOTING_IMPROVEMENTS #feat.

      Here is the research gathered from 3 parallel agents:

      ## OnePlatform Reporting API Research
      @bb/gai/file/api_research.md

      ## Prior Art (Existing Dart Clients)
      @bb/gai/file/prior_art.md

      ## Required Dimensions and Metrics
      @bb/gai/file/dimensions_metrics.md

      #commit:line_chart
